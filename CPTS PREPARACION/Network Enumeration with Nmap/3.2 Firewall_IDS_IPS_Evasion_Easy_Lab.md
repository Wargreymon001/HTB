# Firewall and IDS/IPS Evasion - Easy Lab

## üìò Descripci√≥n del Lab
En este laboratorio se nos presenta un sistema protegido por un **IDS/IPS**.  
Nuestro objetivo es identificar el **sistema operativo** de la m√°quina objetivo, evitando generar demasiadas alertas en el proceso.  
La p√°gina de monitoreo (`http://10.129.2.80/status.php`) muestra el n√∫mero de alertas, lo que nos obliga a ser cuidadosos con los tipos de escaneos que realizamos.

---

## üéØ Objetivo
- Identificar el sistema operativo de la m√°quina remota.
- Evitar ser bloqueados por el IDS/IPS.
- Documentar t√©cnicas de evasi√≥n con **Nmap**.

---

## üõ†Ô∏è Desarrollo

### 1. Verificaci√≥n inicial
Accedemos a la p√°gina de estado:

```
http://10.129.2.80/status.php
```

La p√°gina muestra el n√∫mero de alertas registrados. Por ejemplo:

```
Recorded alerts: 50 / 100 alerts
```

Esto confirma que **cada escaneo incrementa el contador de alertas**.

---

### 2. Escaneo b√°sico de puerto 80
Primero comprobamos si el puerto HTTP estaba abierto:

```bash
sudo nmap -Pn -n -T2 -p 80 10.129.2.80
```

Resultado:

```
PORT   STATE SERVICE
80/tcp open  http
```

El puerto 80 est√° accesible.

---

### 3. Escaneo SYN (con varios puertos)
Probamos un escaneo con `-sA`:

```bash
sudo nmap -sA -p 80,443,445 10.129.2.80
```

Resultado:

```
80/tcp   unfiltered http
443/tcp  filtered   https
445/tcp  filtered   microsoft-ds
```

üëâ El IDS/IPS empieza a generar m√°s alertas aqu√≠ (riesgo alto).

---

### 4. Intento de detecci√≥n de sistema operativo
Probamos con detecci√≥n de OS usando Nmap:

```bash
sudo nmap -O -Pn -n -p 80 10.129.2.80
```

Resultado:

```
OS detection performed.
```

Pero sin √©xito claro: advertencias de que los resultados pod√≠an ser poco fiables.

---

### 5. Afinando detecci√≥n de OS (fuente distinta)
Reintentamos con un puerto de origen distinto:

```bash
sudo nmap -O -Pn -n -p 80 --source-port 53 10.129.2.80
```

Resultado:

```
Aggressive OS guesses:
Linux 4.15 - 5.8 (95%)
Linux 5.0 (95%)
Linux 5.0 - 5.4 (95%)
Linux 3.1 (94%)
Linux 3.2 (94%)
...
```

üëâ Aqu√≠ ya sabemos que el sistema es **Linux**, pero no basta para el flag final (plataforma exige m√°s precisi√≥n).

---

### 6. Escaneo de versiones de servicio
Probamos con `-sV` para obtener banners:

```bash
sudo nmap -sV -p 80 10.129.2.80
```

Resultado:

```
80/tcp open  http   Apache httpd 2.4.29 ((Ubuntu))
```

---

## ‚úÖ Resoluci√≥n
El banner nos confirma no solo el servicio y versi√≥n, sino tambi√©n el sistema operativo:

```
Apache httpd 2.4.29 ((Ubuntu))
```

üëâ La respuesta correcta para la plataforma es:

```
Ubuntu
```

---

## üìö Lecciones aprendidas
1. El IDS/IPS aumenta el contador de alertas cada vez que ejecutamos un escaneo agresivo o repetitivo.  
2. Escaneos de detecci√≥n de OS (`-O`) pueden ser poco fiables con pocos puertos abiertos.  
3. El **escaneo de versiones de servicio (`-sV`)** fue clave para obtener el banner que revel√≥ el OS exacto.  
4. En entornos de examen (como la CPTS), es importante probar rutas alternativas cuando el m√©todo directo (OS fingerprinting) falla.  

---

## üèÅ Conclusi√≥n
- Se logr√≥ identificar correctamente el sistema operativo como **Ubuntu**.
- Se documentaron los intentos fallidos y la importancia de analizar los banners de servicios.
- Este laboratorio refuerza la necesidad de usar t√©cnicas de evasi√≥n y escaneos discretos cuando hay IDS/IPS activos.
