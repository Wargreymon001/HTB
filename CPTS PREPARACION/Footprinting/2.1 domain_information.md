# 🧠 Domain Information

## ✅ Conceptos clave
- El dominio de una empresa es una **fuente crítica de información** en pentesting.  
- Los registros DNS pueden revelar: IPs, servidores de correo, proveedores externos, configuraciones de seguridad, etc.  
- Entender esta información permite **mapear la infraestructura** y detectar vectores de ataque.  

---

## 🔎 Reconocimiento inicial
Ejemplo de búsqueda de información de un host expuesto:

```bash
# Shodan muestra puertos abiertos y versiones de servicios
10.129.27.22
  Ports:
  25/tcp (SMTP)
  53/tcp + udp (DNS)
  80/tcp, 81/tcp (Apache HTTPD)
  110/tcp (POP3)
  111/tcp (RPC)
  443/tcp (Apache HTTPS)
  444/tcp (?)

10.129.27.33
  Ports:
  22/tcp (OpenSSH 7.6p1)
  80/tcp (nginx)
  443/tcp (nginx HTTPS)
```
➡️ Esto nos da servicios visibles y versiones potencialmente vulnerables.

---

## 🌐 DNS Records (búsqueda con dig)
```bash
dig any inlanefreight.com
```

Salida típica:
```
inlanefreight.com. 300  IN  A   10.129.27.33
inlanefreight.com. 300  IN  A   10.129.29.250
inlanefreight.com. 3600 IN  MX  1 aspmx.l.google.com.
inlanefreight.com. 21600 IN NS  ns.inwx.net.
inlanefreight.com. 3600 IN TXT "google-site-verification=..."
inlanefreight.com. 21600 IN SOA ns.inwx.net. hostmaster.inwx.net.
```

---

## 📑 Tipos de registros y utilidad
- **A record** → IP asociada al dominio/subdominio. Ej: `10.129.27.33`.  
- **MX record** → Servidores de correo. Aquí gestionados por Google.  
- **NS record** → Servidores de nombres (ej: `inwx.net`). Identifican al proveedor de hosting.  
- **TXT record** → Contienen claves de verificación (Google, Microsoft, Atlassian, etc.), también configuraciones de seguridad:  
  - **SPF** → Controla qué servidores pueden enviar correos.  
  - **DKIM** → Firma criptográfica para validar origen.  
  - **DMARC** → Política de verificación de correos.  
- **SOA record** → Datos administrativos del dominio.  

---

## 🏢 Proveedores externos detectados
A través de los TXT y MX vemos que la empresa usa servicios de terceros:

| Proveedor   | Uso principal |
|-------------|---------------|
| Atlassian   | Gestión de proyectos / software |
| Google Gmail| Correo corporativo |
| LogMeIn     | Acceso remoto y administración |
| Mailgun     | APIs y relays de correo |
| Outlook / O365 | Gestión documental, OneDrive, Azure Blob |
| INWX        | Hosting / registro de dominios |

➡️ Cada uno de estos puede convertirse en un vector de ataque (phishing, password reuse, vulnerabilidades en APIs, etc.).  

---

## 💡 Ejemplos prácticos
- **Identificar IPs adicionales** en registros `A`: más hosts para escanear.  
- **Analizar registros MX** → Saber si el correo está en Google / Microsoft.  
- **TXT SPF** → Ver qué servicios tienen permiso para enviar correos → posible spoofing si mal configurado.  
- **Detección de SaaS externos** (Atlassian, LogMeIn, etc.) → posibles ataques a la nube.  

---

## 💻 Comandos útiles
```bash
# Consultar todos los registros DNS de un dominio
dig any dominio.com

# Consultar solo los registros A
dig A dominio.com

# Consultar servidores de correo
dig MX dominio.com

# Consultar servidores de nombres
dig NS dominio.com

# Verificación con nslookup (modo interactivo)
nslookup
> server 8.8.8.8
> set type=any
> dominio.com

# Herramienta rápida
host -a dominio.com
```

---

## 📌 Resumen clave
- Los **DNS records** revelan infraestructura y servicios de terceros.  
- Registros importantes: **A, MX, NS, TXT, SOA**.  
- **TXT** puede mostrar verificaciones de Google, Microsoft, Atlassian, LogMeIn, etc.  
- Analizar proveedores externos = más vectores de ataque.  
- **Cheat sheet de comandos**: `dig`, `host`, `nslookup`.  
